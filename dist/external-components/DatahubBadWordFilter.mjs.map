{"version":3,"file":"DatahubBadWordFilter.mjs","sources":["../../src/components/dataTypes/BadWordFilter/constants.ts","../../src/components/dataTypes/BadWordFilter/DatahubBadWordFilter.vue"],"sourcesContent":["import type { ITableConfig } from \"@actindo/core-ui\";\n\nexport const BAD_WORDS_LIST: ITableConfig = {\n  hideGlobalSearch: true,\n  minRowCount: 1,\n  canReorderRows: false,\n  hidePagination: true,\n  canReorderHeaders: false,\n  columns: [\n    {\n      id: \"text\",\n      header: \"\",\n      accessor: (row) => row,\n    },\n  ],\n};\n","<script setup lang=\"ts\">\nimport { computed, ref, watch } from \"vue\";\nimport {\n  ARow,\n  ACol,\n  ASelect,\n  AContainer,\n  ATextField,\n  ActindoDataList,\n  type ICellProperty,\n} from \"@actindo/core-ui\";\nimport type { ITenantAttributeLanguage } from \"@/services/api/DataHub/Languages\";\nimport type { ITenantAttributeScope } from \"@/services/api/DataHub/Scopes\";\nimport type { IDataTypesStringValueBadWords } from \"./models\";\nimport { BAD_WORDS_LIST } from \"./constants\";\nimport { useI18n } from \"vue-i18n\";\n\nconst props = withDefaults(\n  defineProps<{\n    modelValue: IDataTypesStringValueBadWords;\n    scopable: boolean;\n    remoteScopes?: ITenantAttributeScope[];\n    multiLanguage: boolean;\n    remoteLanguages?: ITenantAttributeLanguage[];\n    readonly?: boolean;\n  }>(),\n  {\n    remoteScopes: () => [],\n    remoteLanguages: () => [],\n  },\n);\n\nconst { t } = useI18n();\n\nconst badwords = defineModel<IDataTypesStringValueBadWords>({\n  default: () => ({}) as IDataTypesStringValueBadWords,\n});\n\nconst currentScopeId = ref(0);\nconst currentLanguageId = ref(0);\n\nconst hideBadWords = computed(\n  () =>\n    (props.multiLanguage && !currentLanguageId.value) ||\n    (props.scopable && !currentScopeId.value),\n);\n\nconst activeBadWords = computed(\n  () =>\n    badwords.value?.[currentScopeId.value]?.[currentLanguageId.value] ?? [\"\"],\n);\n\nwatch(\n  [currentScopeId, currentLanguageId],\n  ([currentScope, currentLanguage]) => {\n    // PHP converts single scope and language object that looks like `{ 0: { 0: ['bad word'] }}`\n    // to an array `[[['bad word']]]`, so we need to convert it back\n    const badWordsAsArray =\n      badwords.value instanceof Array &&\n      badwords.value.length === 1 &&\n      badwords.value[0].length === 1;\n    const value = badWordsAsArray\n      ? { 0: { 0: badwords.value[0][0] } }\n      : badwords.value;\n\n    if (!value[currentScope]) {\n      value[currentScope] = {};\n    }\n    if (!value[currentScope][currentLanguage]) {\n      value[currentScope][currentLanguage] = [\"\"];\n    }\n\n    badwords.value = value;\n  },\n  { immediate: true },\n);\n\nfunction deleteWord({ rowIndex }: ICellProperty) {\n  if (\n    badwords.value[currentScopeId.value][currentLanguageId.value].length > 1\n  ) {\n    badwords.value[currentScopeId.value][currentLanguageId.value].splice(\n      rowIndex,\n      1,\n    );\n  } else {\n    badwords.value[currentScopeId.value][currentLanguageId.value] = [\"\"];\n  }\n}\n\nfunction addWord() {\n  badwords.value[currentScopeId.value][currentLanguageId.value].push(\"\");\n}\n</script>\n\n<template>\n  <AContainer fluid>\n    <ARow>\n      <ACol cols=\"12\" class=\"d-flex align-center\">\n        <strong class=\"mr-2\">\n          {{ t(\"datahub-plugin.stringValue.badWords\") }}\n        </strong>\n        <ASelect\n          v-if=\"scopable && remoteScopes.length\"\n          v-model=\"currentScopeId\"\n          :items=\"remoteScopes\"\n          :label=\"t('datahub-plugin.stringValue.scope')\"\n          :readonly=\"readonly\"\n          :disabled=\"readonly\"\n          item-title=\"name\"\n          item-value=\"id\"\n          class=\"mr-2\"\n        />\n        <ASelect\n          v-if=\"multiLanguage && remoteLanguages.length\"\n          v-model=\"currentLanguageId\"\n          :items=\"remoteLanguages\"\n          :label=\"t('datahub-plugin.stringValue.language')\"\n          :readonly=\"readonly\"\n          :disabled=\"readonly\"\n          item-title=\"description\"\n          item-value=\"id\"\n          class=\"mr-2\"\n        />\n      </ACol>\n      <ACol>\n        <template v-if=\"hideBadWords\">\n          {{ t(\"datahub-plugin.stringValue.wrongScopeLanguage\") }}\n        </template>\n        <template v-else>\n          <ActindoDataList\n            :data=\"activeBadWords\"\n            :create-actions=\"\n              readonly || [\n                {\n                  title: t('datahub-plugin.stringValue.addWord'),\n                  icon: 'add_circle',\n                },\n              ]\n            \"\n            :readonly=\"readonly\"\n            v-bind=\"BAD_WORDS_LIST\"\n            @create=\"addWord\"\n            @remove=\"deleteWord\"\n          >\n            <template #cell-text=\"{ rowIndex }\">\n              <ATextField\n                v-model=\"badwords[currentScopeId][currentLanguageId][rowIndex]\"\n                :readonly=\"readonly\"\n              />\n            </template>\n          </ActindoDataList>\n        </template>\n      </ACol>\n    </ARow>\n  </AContainer>\n</template>\n\n<i18n>\n{\n  \"en\": {\n    \"datahub-plugin\": {\n      \"stringValue\": {\n        \"badWords\": \"Bad Words\",\n        \"scope\": \"Scope\",\n        \"language\": \"Language\",\n        \"wrongScopeLanguage\": \"Please select a valid scope and language combination to edit bad words\",\n        \"addWord\": \"Add word\"\n      }\n    }\n  },\n  \"de\": {\n    \"badWords\": \"Unerwünschte Wörter\",\n\n    \"scope\": \"Kanal\",\n    \"language\": \"Sprache\",\n    \"wrongScopeLanguage\": \"Bitte wählen Sie eine gültige Kanal- und Sprachkombination aus, um unerwünschte Wörter zu bearbeiten\",\n    \"addWord\": \"Wort hinzufügen\"\n  }\n}\n</i18n>\n"],"names":["Scope","Please select a valid scope and language combination to edit bad words","Add word","Unerwünschte Wörter","Kanal","Sprache","Wort hinzufügen"],"mappings":"AAEO,MAAM,iBAA+B;AAAA,EAC1C,kBAAkB;AAAA,EAClB,aAAa;AAAA,EACb,gBAAgB;AAAA,EAChB,gBAAgB;AAAA,EAChB,mBAAmB;AAAA,EACnB,SAAS;AAAA,IACP;AAAA,MACE,IAAI;AAAA,MACJ,QAAQ;AAAA,MACR,UAAU,CAAC,QAAQ;AAAA,IACrB;AAAA,EACF;AACF;;;;;;;;;;;;;;;;;ACdA,MAAA,WAAA,OAAA,KAAA,EAAA;;;AACA,MAAA,OAAA,OAAA,eAAA,EAAA;;;;;;AAaA,MAAA,UAAA,OAAA,SAAA,EAAA;;;;;;;;;;;;;;;;;;AAEA,UAAM,QAAQ;AAeR,UAAA,EAAE,MAAM;AAER,UAAA,WAAW,UAEhB,SAAA,YAAA;AAEK,UAAA,iBAAiB,IAAI,CAAC;AACtB,UAAA,oBAAoB,IAAI,CAAC;AAE/B,UAAM,eAAe;AAAA,MACnB,MACG,MAAM,iBAAiB,CAAC,kBAAkB,SAC1C,MAAM,YAAY,CAAC,eAAe;AAAA,IAAA;AAGvC,UAAM,iBAAiB;AAAA,MACrB;AD9CK;AC+CH,qCAAS,UAAT,mBAAiB,eAAe,WAAhC,mBAAyC,kBAAkB,WAAU,CAAC,EAAE;AAAA;AAAA,IAAA;AAG5E;AAAA,MACE,CAAC,gBAAgB,iBAAiB;AAAA,MAClC,CAAC,CAAC,cAAc,eAAe,MAAM;AAGnC,cAAM,kBACJ,SAAS,iBAAiB,SAC1B,SAAS,MAAM,WAAW,KAC1B,SAAS,MAAM,CAAC,EAAE,WAAW;AAC/B,cAAM,QAAQ,kBACV,EAAE,GAAG,EAAE,GAAG,SAAS,MAAM,CAAC,EAAE,CAAC,EAAE,EAAA,IAC/B,SAAS;AAET,YAAA,CAAC,MAAM,YAAY,GAAG;AAClB,gBAAA,YAAY,IAAI;QACxB;AACA,YAAI,CAAC,MAAM,YAAY,EAAE,eAAe,GAAG;AACzC,gBAAM,YAAY,EAAE,eAAe,IAAI,CAAC,EAAE;AAAA,QAC5C;AAEA,iBAAS,QAAQ;AAAA,MACnB;AAAA,MACA,EAAE,WAAW,KAAK;AAAA,IAAA;AAGX,aAAA,WAAW,EAAE,YAA2B;AAE7C,UAAA,SAAS,MAAM,eAAe,KAAK,EAAE,kBAAkB,KAAK,EAAE,SAAS,GACvE;AACA,iBAAS,MAAM,eAAe,KAAK,EAAE,kBAAkB,KAAK,EAAE;AAAA,UAC5D;AAAA,UACA;AAAA,QAAA;AAAA,MACF,OACK;AACI,iBAAA,MAAM,eAAe,KAAK,EAAE,kBAAkB,KAAK,IAAI,CAAC,EAAE;AAAA,MACrE;AAAA,IACF;AAEA,aAAS,UAAU;AACR,eAAA,MAAM,eAAe,KAAK,EAAE,kBAAkB,KAAK,EAAE,KAAK,EAAE;AAAA,IACvE;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;MAwEiBA,MAAAA;AAAAA;UAEaC,eAAAA;AAAAA,YACXC,YAAAA,CAAAA,QAAAA;AAAAA,oBAAAA,EAAAA,WAAAA,eAAAA;AAAAA,qBAAAA,WAAAA,CAAAA,WAAAA,CAAAA;AAAAA,YAAAA;AAAAA;;;;;;;;;;;;;;;;UAKLC;AAAAA;MAEDC;AAAAA,MACGC,MAAAA;AAAAA;;;;QAEHC,SAAAA,CAAAA,QAAAA;AAAAA,gBAAAA,EAAAA,WAAAA,eAAAA;AAAAA,iBAAAA,WAAAA,CAAAA,OAAAA,CAAAA;AAAAA,QAAAA;AAAAA;;;;;;;;;;;;;;;;;;"}