{"version":3,"file":"DatahubBadWordFilter.vue_vue_type_script_setup_true_lang-f6c97c84.mjs","sources":["../../src/components/dataTypes/StringValue/constants.ts","../../src/components/dataTypes/StringValue/DatahubBadWordFilter.vue"],"sourcesContent":["import type { ITableConfig } from \"@actindo/core-ui\";\n\nexport const BAD_WORDS_LIST: ITableConfig = {\n  hideGlobalSearch: true,\n  minRowCount: 1,\n  canReorderRows: false,\n  hidePagination: true,\n  canReorderHeaders: false,\n  columns: [\n    {\n      id: \"text\",\n      header: \"\",\n      accessor: (row) => row,\n    },\n  ],\n};\n","<script setup lang=\"ts\">\nimport { computed, ref, watch } from \"vue\";\nimport {\n  ARow,\n  ACol,\n  ASelect,\n  AContainer,\n  ATextField,\n  ActindoDataList,\n  type ICellProperty,\n} from \"@actindo/core-ui\";\nimport type { ITenantAttributeLanguage } from \"@/services/api/DataHub/Languages\";\nimport type { ITenantAttributeScope } from \"@/services/api/DataHub/Scopes\";\nimport type { IDataTypesStringValueBadWords } from \"./models\";\nimport { BAD_WORDS_LIST } from \"./constants\";\n\nconst props = withDefaults(\n  defineProps<{\n    modelValue: IDataTypesStringValueBadWords;\n    scopable: boolean;\n    remoteScopes?: ITenantAttributeScope[];\n    multiLanguage: boolean;\n    remoteLanguages?: ITenantAttributeLanguage[];\n  }>(),\n  {\n    remoteScopes: () => [],\n    remoteLanguages: () => [],\n  },\n);\n\nconst badwords = defineModel<IDataTypesStringValueBadWords>({\n  default: () => ({}) as IDataTypesStringValueBadWords,\n});\n\nconst currentScopeId = ref(0);\nconst currentLanguageId = ref(0);\n\nconst hideBadWords = computed(\n  () =>\n    (props.multiLanguage && !currentLanguageId.value) ||\n    (props.scopable && !currentScopeId.value),\n);\n\nconst activeBadWords = computed(\n  () =>\n    badwords.value?.[currentScopeId.value]?.[currentLanguageId.value] ?? [\"\"],\n);\n\nwatch(\n  [currentScopeId, currentLanguageId],\n  ([currentScope, currentLanguage]) => {\n    // PHP converts single scope and language object that looks like `{ 0: { 0: ['bad word'] }}`\n    // to an array `[[['bad word']]]`, so we need to convert it back\n    const badWordsAsArray =\n      badwords.value instanceof Array &&\n      badwords.value.length === 1 &&\n      badwords.value[0].length === 1;\n    const value = badWordsAsArray\n      ? { 0: { 0: badwords.value[0][0] } }\n      : badwords.value;\n\n    if (!value[currentScope]) {\n      value[currentScope] = {};\n    }\n    if (!value[currentScope][currentLanguage]) {\n      value[currentScope][currentLanguage] = [\"\"];\n    }\n\n    badwords.value = value;\n  },\n  { immediate: true },\n);\n\nfunction deleteWord({ rowIndex }: ICellProperty) {\n  if (\n    badwords.value[currentScopeId.value][currentLanguageId.value].length > 1\n  ) {\n    badwords.value[currentScopeId.value][currentLanguageId.value].splice(\n      rowIndex,\n      1,\n    );\n  } else {\n    badwords.value[currentScopeId.value][currentLanguageId.value] = [\"\"];\n  }\n}\n\nfunction addWord() {\n  badwords.value[currentScopeId.value][currentLanguageId.value].push(\"\");\n}\n</script>\n\n<template>\n  <AContainer>\n    <ARow>\n      <ACol cols=\"12\" class=\"d-flex align-center\">\n        <strong class=\"mr-2\">{{ $t(\"stringValue.badWords\") }}</strong>\n        <ASelect\n          v-if=\"scopable && remoteScopes.length\"\n          v-model=\"currentScopeId\"\n          :items=\"remoteScopes\"\n          :label=\"$t('stringValue.scope')\"\n          item-title=\"name\"\n          item-value=\"id\"\n          class=\"mr-2\"\n        />\n        <ASelect\n          v-if=\"multiLanguage && remoteLanguages.length\"\n          v-model=\"currentLanguageId\"\n          :items=\"remoteLanguages\"\n          :label=\"$t('stringValue.language')\"\n          item-title=\"description\"\n          item-value=\"id\"\n          class=\"mr-2\"\n        />\n      </ACol>\n      <ACol>\n        <template v-if=\"hideBadWords\">\n          {{ $t(\"stringValue.wrongScopeLanguage\") }}\n        </template>\n        <template v-else>\n          <ActindoDataList\n            :data=\"activeBadWords\"\n            :create-actions=\"[\n              { title: $t('stringValue.addWord'), icon: 'add_circle' },\n            ]\"\n            v-bind=\"BAD_WORDS_LIST\"\n            @create=\"addWord\"\n            @remove=\"deleteWord\"\n          >\n            <template #cell-text=\"{ rowIndex }\">\n              <ATextField\n                v-model=\"badwords[currentScopeId][currentLanguageId][rowIndex]\"\n              />\n            </template>\n          </ActindoDataList>\n        </template>\n      </ACol>\n    </ARow>\n  </AContainer>\n</template>\n"],"names":[],"mappings":"AAEO,MAAM,iBAA+B;AAAA,EAC1C,kBAAkB;AAAA,EAClB,aAAa;AAAA,EACb,gBAAgB;AAAA,EAChB,gBAAgB;AAAA,EAChB,mBAAmB;AAAA,EACnB,SAAS;AAAA,IACP;AAAA,MACE,IAAI;AAAA,MACJ,QAAQ;AAAA,MACR,UAAU,CAAC,QAAQ;AAAA,IACrB;AAAA,EACF;AACF;;;;;;;;;;;;;;;;;ACdA,MAAA,WAAA,OAAA,KAAA,EAAA;;;AACA,MAAA,OAAA,OAAA,eAAA,EAAA;;;;;;;;;;;;;;;;;;;;;AAcA,UAAM,QAAQ;AAcR,UAAA,WAAW;AAIX,UAAA,iBAAiB,IAAI,CAAC;AACtB,UAAA,oBAAoB,IAAI,CAAC;AAE/B,UAAM,eAAe;AAAA,MACnB,MACG,MAAM,iBAAiB,CAAC,kBAAkB,SAC1C,MAAM,YAAY,CAAC,eAAe;AAAA,IAAA;AAGvC,UAAM,iBAAiB;AAAA,MACrB;AD1CK;AC2CH,qCAAS,UAAT,mBAAiB,eAAe,WAAhC,mBAAyC,kBAAkB,WAAU,CAAC,EAAE;AAAA;AAAA,IAAA;AAG5E;AAAA,MACE,CAAC,gBAAgB,iBAAiB;AAAA,MAClC,CAAC,CAAC,cAAc,eAAe,MAAM;AAGnC,cAAM,kBACJ,SAAS,iBAAiB,SAC1B,SAAS,MAAM,WAAW,KAC1B,SAAS,MAAM,CAAC,EAAE,WAAW;AAC/B,cAAM,QAAQ,kBACV,EAAE,GAAG,EAAE,GAAG,SAAS,MAAM,CAAC,EAAE,CAAC,EAAE,EAAA,IAC/B,SAAS;AAET,YAAA,CAAC,MAAM,YAAY,GAAG;AAClB,gBAAA,YAAY,IAAI;QACxB;AACA,YAAI,CAAC,MAAM,YAAY,EAAE,eAAe,GAAG;AACzC,gBAAM,YAAY,EAAE,eAAe,IAAI,CAAC,EAAE;AAAA,QAC5C;AAEA,iBAAS,QAAQ;AAAA,MACnB;AAAA,MACA,EAAE,WAAW,KAAK;AAAA,IAAA;AAGX,aAAA,WAAW,EAAE,YAA2B;AAE7C,UAAA,SAAS,MAAM,eAAe,KAAK,EAAE,kBAAkB,KAAK,EAAE,SAAS,GACvE;AACA,iBAAS,MAAM,eAAe,KAAK,EAAE,kBAAkB,KAAK,EAAE;AAAA,UAC5D;AAAA,UACA;AAAA,QAAA;AAAA,MACF,OACK;AACI,iBAAA,MAAM,eAAe,KAAK,EAAE,kBAAkB,KAAK,IAAI,CAAC,EAAE;AAAA,MACrE;AAAA,IACF;AAEA,aAAS,UAAU;AACR,eAAA,MAAM,eAAe,KAAK,EAAE,kBAAkB,KAAK,EAAE,KAAK,EAAE;AAAA,IACvE;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;"}